<div class="page">
  <div class="page_title">Notifications</div>

  <!------------ 여기부터 정리 필요 ------------>
  <form [formGroup]="searchNotificationForm" novalidate>
    <div class="add_container" fxLayoutAlign="center center">
      <div class="selectContent" fxLayout="row wrap">
        <div class="selectBoxContent">
          <div class="selectBox">
            <span class="selectLabel">
              <label for="type" class="optionLabel fontBold">Type</label>
            </span>
            <mat-form-field appearance="outline" class="formFieldBox formSpacer">
              <mat-select formControlName="searchCondition" required>
                <mat-option *ngFor="let searchCondition of searchConditionList" [value]="searchCondition">
                  {{searchCondition}}
                </mat-option>
              </mat-select>
            </mat-form-field>
          </div>
        </div>

        <div class="selectBoxContent">
          <div class="selectBox">
            <span class="selectLabel">
              <label for="typeText" class="optionLabel fontBold"></label>
            </span>
            <mat-form-field class="formEmailFieldBox" appearance="outline">
              <mat-label>Type Text</mat-label>
              <!-- https://stackoverflow.com/questions/5601647/html5-email-input-pattern-attribute -->
              <input matInput type="text" formControlName="searchConditionValue" />
            </mat-form-field>
          </div>
        </div>
        <div class="selectBoxContent">
          <div class="selectBox">
            <span class="selectLabel">
              <label for="period" class="optionLabel fontBold">Period</label>
            </span>
            <mat-form-field class="formFieldBox" appearance="outline">
              <mat-label>Choose a date</mat-label>
              <input matInput [matDatepicker]="picker1" formControlName="startDate">
              <mat-datepicker-toggle matSuffix [for]="picker1"></mat-datepicker-toggle>
              <mat-datepicker #picker1></mat-datepicker>
            </mat-form-field>
            <label class="calenderLabel waveSpacer"> ~ </label>
            <mat-form-field class="formFieldBox" appearance="outline">
              <mat-label>Choose a date</mat-label>
              <input matInput [matDatepicker]="picker2" formControlName="endDate">
              <mat-datepicker-toggle matSuffix [for]="picker2"></mat-datepicker-toggle>
              <mat-datepicker #picker2></mat-datepicker>
            </mat-form-field>
          </div>
        </div>

        <div class="searchBox" fxLayout="row nowrap" fxLayoutAlign="center center">
          <div>
            <button mat-flat-button class="searchBtn" (click)="getNotifications();">Search</button>
          </div>
          <div>
            <button mat-flat-button class="searchBtn" (click)="createNotification();">Create</button>
          </div>
        </div>


      </div>

    </div>

  </form>

  <div class="button">
    <p>Announcement</p>
    <mat-button-toggle-group [(ngModel)]="category" (ngModelChange)="getNotifications()">
      <mat-button-toggle value="All"
        style="min-width:110px; margin-right:10px; border-radius: 5px 5px 0 0;">All</mat-button-toggle>
      <mat-button-toggle value="Notice"
        style="min-width:110px; margin-right:10px; border-radius: 5px 5px 0 0; border-left: none;">Notice</mat-button-toggle>
      <mat-button-toggle value="Meeting"
        style="min-width:110px; margin-right:10px; border-radius: 5px 5px 0 0; border-left: none;">Meeting</mat-button-toggle>
      <mat-button-toggle value="Pay"
        style="min-width:110px; margin-right:10px; border-radius: 5px 5px 0 0; border-left: none;">Pay</mat-button-toggle>
      <mat-button-toggle value="Policy"
        style="min-width:110px; margin-right:10px; border-radius: 5px 5px 0 0; border-left: none;">Policy</mat-button-toggle>
      <mat-button-toggle value="Issue"
        style="min-width:110px; margin-right:10px; border-radius: 5px 5px 0 0; border-left: none;">Issue</mat-button-toggle>
      <mat-button-toggle value="Etc"
        style="min-width:110px; border-radius: 5px 5px 0 0; border-left: none;">Etc</mat-button-toggle>
    </mat-button-toggle-group>
  </div>

  <div class="table_container">
    <!-- <div class="example-loading-shade" *ngIf="isLoadingResults || isRateLimitReached">
      <mat-spinner *ngIf="isLoadingResults"></mat-spinner>
      <div class="example-rate-limit-reached" *ngIf="isRateLimitReached">
        API rate limit has been reached. It will be reset in one minute.
      </div>
    </div> -->

    <!-- <mat-chip-set>
      <mat-chip-listbox [value]="selectedCategory">
        <mat-chip-option *ngFor="let category of categoryList" [selectable]="false"
          (click)="category !== selectedCategory && getNotifications(category)">{{category}}</mat-chip-option>
      </mat-chip-listbox>
    </mat-chip-set> -->

    <table mat-table class="table" [dataSource]="dataSource" matSort matSortActive="createdAt" matSortDisableClear
      matSortDirection="desc">

      <ng-container matColumnDef="category">
        <th mat-header-cell *matHeaderCellDef> Category </th>
        <td mat-cell *matCellDef="let element"> {{element?.category}} </td>
      </ng-container>

      <ng-container matColumnDef="title">
        <th mat-header-cell *matHeaderCellDef> Title </th>
        <td mat-cell *matCellDef="let element"> {{element?.title}} </td>
      </ng-container>

      <ng-container matColumnDef="writer">
        <th mat-header-cell *matHeaderCellDef> Writer </th>
        <td mat-cell *matCellDef="let element"> {{element?.writer?.username}} </td>
      </ng-container>

      <ng-container matColumnDef="createdAt">
        <th mat-header-cell *matHeaderCellDef> Date </th>
        <td mat-cell *matCellDef="let element"> {{element?.createdAt | date: 'YYYY-MM-dd'}}</td>
      </ng-container>

      <ng-container matColumnDef="menu">
        <th mat-header-cell *matHeaderCellDef></th>
        <td mat-cell *matCellDef="let element">
          <button mat-icon-button [matMenuTriggerFor]="menu"
            (click)="$event.stopPropagation()"><mat-icon>more_vert</mat-icon></button>
          <mat-menu #menu="matMenu">
            <button mat-menu-item (click)="editNotification(element._id)">Edit</button>
            <button mat-menu-item (click)="deleteNotification(element._id)">Delete</button>
          </mat-menu>
        </td>
      </ng-container>



      <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
      <tr mat-row *matRowDef="let row; columns: displayedColumns;" (click)="onClick(row._id)"></tr>
      <tr class="mat-row" *matNoDataRow>
        <td class="mat-cell" colspan="9999">
          No data
        </td>
      </tr>
    </table>

    <mat-paginator [length]="resultsLength" [pageSize]="8" [pageSizeOptions]="[5, 10, 50]"
      showFirstLastButtons></mat-paginator>

  </div>

</div>